<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>File experiment</title>
</head>
<body>

	<h1>File experiment</h1>

	<h2>Blob.arrayBuffer()</h2>
	<input type="file" name="arrayBuffer" id="arrayBuffer">
	<div id="arrayBufferResult"></div>

	<h2>FileReader.readAsArrayBuffer()</h2>
	<input type="file" name="readAsArrayBuffer" id="readAsArrayBuffer">
	<div id="readAsArrayBufferResult"></div>

	<script type="text/javascript">
		const e1 = document.getElementById('arrayBuffer')
		const r1 = document.getElementById('arrayBufferResult')
		e1.addEventListener('change', (event) => {
			const f = event.target.files[0]
			f.arrayBuffer()
        .then(buffer => r1.innerHTML = 'OK')
        .catch(e => r1.innerHTML = 'KO')
		})

		const e2 = document.getElementById('readAsArrayBuffer')
    const r2 = document.getElementById('readAsArrayBufferResult')
    e2.addEventListener('change', (event) => {
      
      new Promise((resolve, reject) => {
        const f = event.target.files[0]
        const reader = new FileReader()
        reader.onload = (e) => { resolve(e) }
        reader.readAsArrayBuffer(f)
      })
      .then(buffer => r2.innerHTML = 'OK')
      .catch(e => r2.innerHTML = 'KO')
		})

	</script>


</body>
</html>

